var ref=new Firebase("https://glowing-fire-6341.firebaseio.com"),app=angular.module("app",["ngRoute","ngCookies","firebase"]).config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"/pages/event.html",controller:"eventCtrl"}).when("/sign-up",{templateUrl:"/pages/sign-up.html",controller:"signUpCtrl"}).when("/login",{templateUrl:"/pages/login.html",controller:"loginCtrl"}).otherwise({redirectTo:"/"}),t.html5Mode(!0)}]).run(["$rootScope","$location","$cookies",function(e,t,o){var n=o.get("user");e.loggedInUser=n,e.$on("$routeChangeStart",function(o,n,r){if(!e.loggedInUser){var a=["/pages/login.html","/pages/sign-up.html"];-1==a.indexOf(n.templateUrl)&&t.path("/login")}})}]).directive("autofocus",["$timeout",function(e){return{restrict:"A",link:function(t,o){e(function(){o[0].focus()})}}}]);app.controller("eventCtrl",["$scope","$rootScope","$firebaseArray","$cookies","$location",function(e,t,o,n,r){e.currentEvents=o(ref.child("events")),e.newEvent={guestList:[]},e.addEvent=function(o){o&&(e.newEvent.user=t.loggedInUser,e.newEvent.startDate=e.newEvent.startDate.getTime(),e.newEvent.endDate=e.newEvent.endDate.getTime(),ref.child("events").push().set(e.newEvent),e.newEvent={guestList:[]},e.eventForm.$setPristine(!0),e.eventForm.$setUntouched(!0))},e.addGuest=function(){e.newEvent.guestList.push(e.guest),e.guest=""},e.logout=function(){t.loggedInUser=null,n.remove("user"),r.path("/login")},"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(e){},function(e){console.log("ERROR:"+e.code+" - "+e.message)})}]),app.controller("loginCtrl",["$scope","$firebaseAuth","$location","$cookies","$rootScope",function(e,t,o,n,r){r.loggedInUser&&o.path("/"),auth=t(ref),e.remember=!1,e.formData={email:"",password:""},e.login=function(t){e.authData=null,auth.$authWithPassword(t).then(function(t){e.remember&&n.put("user",t.uid),r.loggedInUser=t.uid,o.path("/")})["catch"](function(t){e.errors=[],e.errors.push(t)})}}]),app.controller("signUpCtrl",["$scope","$http","$location","$rootScope",function(e,t,o,n){n.loggedInUser&&o.path("/"),e.formData={},e.processForm=function(){e.errors=[],ref.createUser({email:e.formData.email,password:e.formData.password},function(t,n){if(t)console.log(t),e.errors.push(t);else{var r=ref.child("users");r.child(n.uid).set({name:e.formData.name,bio:e.formData.bio},function(){ref.authWithPassword({email:e.formData.email,password:e.formData.password},function(t,n){t?(console.log(t),e.errors.push(t)):o.path("/")})})}})}}]);