var ref=new Firebase("https://glowing-fire-6341.firebaseio.com"),app=angular.module("app",["ngRoute","ngCookies","firebase"]).config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"/pages/event.html",controller:"eventCtrl"}).when("/sign-up",{templateUrl:"/pages/sign-up.html",controller:"signUpCtrl"}).when("/login",{templateUrl:"/pages/login.html",controller:"loginCtrl"}).otherwise({redirectTo:"/"}),t.html5Mode(!0)}]).run(["$rootScope","$location","$cookies",function(e,t,n){var o=n.get("user");e.loggedInUser=o,e.$on("$routeChangeStart",function(n,o,r){if(!e.loggedInUser){var i=["/pages/login.html","/pages/sign-up.html"];-1==i.indexOf(o.templateUrl)&&t.path("/login")}})}]).directive("autofocus",["$timeout",function(e){return{restrict:"A",link:function(t,n){e(function(){n[0].focus()})}}}]);app.controller("eventCtrl",["$scope","$rootScope","$firebaseArray","$cookies","$location",function(e,t,n,o,r){e.currentEvents=n(ref.child("events")),e.newEvent={guestList:[]},e.addEvent=function(n){n&&(e.newEvent.user=t.loggedInUser,e.newEvent.startDate=e.newEvent.startDate.getTime(),e.newEvent.endDate=e.newEvent.endDate.getTime(),ref.child("events").push().set(e.newEvent),e.newEvent={guestList:[]},e.eventForm.$setPristine(!0),e.eventForm.$setUntouched(!0))},e.addGuest=function(){e.newEvent.guestList.push(e.guest),e.guest=""},e.logout=function(){t.loggedInUser=null,o.remove("user"),r.path("/login")},"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(e){},function(e){console.log("ERROR:"+e.code+" - "+e.message)})}]),app.controller("loginCtrl",["$scope","$firebaseAuth","$location","$cookies","$rootScope",function(e,t,n,o,r){r.loggedInUser&&n.path("/"),auth=t(ref),e.remember=!1,e.loginData={email:"",password:""},e.login=function(t){t&&(e.authData=null,auth.$authWithPassword(e.loginData).then(function(t){e.remember&&o.put("user",t.uid),r.loggedInUser=t.uid,n.path("/")})["catch"](function(t){e.errors=[],e.errors.push(t)}))}}]),app.controller("signUpCtrl",["$scope","$http","$location","$rootScope",function(e,t,n,o){o.loggedInUser&&n.path("/"),e.signUpData={},e.userData={name:"",bio:""},e.processForm=function(t){t&&ref.createUser({email:e.signUpData.email,password:e.signUpData.password},function(t,r){if(t)e.errors=[],e.errors.push(t);else{var i=ref.child("users");i.child(r.uid).set(e.userData,function(){o.$apply(function(){n.path("/login"),console.log(n.path())})})}})}}]);